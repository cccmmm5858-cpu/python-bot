# astro_rules.py

PLANET_MEANINGS = {
    "Sun": "Ø§Ù„ÙˆØ¶ÙˆØ­ ÙˆØ§Ù„Ø§Ù†ØªØ´Ø§Ø±",
    "Moon": "Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„ÙŠÙ† ÙˆØ§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†",
    "Mercury": "Ø§Ù„Ø¹Ù‚ÙˆØ¯ ÙˆØ§Ù„Ù…Ù‚Ø§ÙŠØ¶Ø§Øª",
    "Venus": "Ø§Ù„Ù‚ÙŠÙ…Ø© ÙˆØ§Ù„Ù…ÙƒØ§Ø³Ø¨",
    "Mars": "Ø§Ù„ØªØ³Ø§Ø±Ø¹Ø§Øª ÙˆØ§Ù„Ø­Ø±ÙƒØ©",
    "Jupiter": "Ø§Ù„ÙˆÙØ±Ø© ÙˆØ§Ù„Ø³ÙŠÙˆÙ„Ø©",
    "Saturn": "Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†",
    "Uranus": "Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø± ÙˆØ§Ù„Ù…ÙØ§Ø¬Ø£Ø©",
    "Neptune": "Ø§Ù„Ø®Ø¯Ø¹Ø© ÙˆØ§Ù„Ø§Ø®ØªØ±Ø§Ø¹Ø§Øª",
    "Pluto": "Ø§Ù„Ù‡Ø¯Ù… ÙˆØ§Ù„Ø¨Ù†Ø§Ø¡",
    "North Node": "Ø§Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø´Ù…Ø§Ù„ÙŠØ© (Ø§Ù„ÙˆØ¬Ù‡Ø©)",
    "South Node": "Ø§Ù„Ø¹Ù‚Ø¯Ø© Ø§Ù„Ø¬Ù†ÙˆØ¨ÙŠØ© (Ø§Ù„ØªØ®Ù„ÙŠ)",
    "Ø§Ù„Ø´Ù…Ø³": "Ø§Ù„ÙˆØ¶ÙˆØ­ ÙˆØ§Ù„Ø§Ù†ØªØ´Ø§Ø±",
    "Ø§Ù„Ù‚Ù…Ø±": "Ø§Ù„Ù…ØªØ¯Ø§ÙˆÙ„ÙŠÙ† ÙˆØ§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†",
    "Ø¹Ø·Ø§Ø±Ø¯": "Ø§Ù„Ø¹Ù‚ÙˆØ¯ ÙˆØ§Ù„Ù…Ù‚Ø§ÙŠØ¶Ø§Øª",
    "Ø§Ù„Ø²Ù‡Ø±Ø©": "Ø§Ù„Ù‚ÙŠÙ…Ø© ÙˆØ§Ù„Ù…ÙƒØ§Ø³Ø¨",
    "Ø§Ù„Ù…Ø±ÙŠØ®": "Ø§Ù„ØªØ³Ø§Ø±Ø¹Ø§Øª ÙˆØ§Ù„Ø­Ø±ÙƒØ©",
    "Ø§Ù„Ù…Ø´ØªØ±ÙŠ": "Ø§Ù„ÙˆÙØ±Ø© ÙˆØ§Ù„Ø³ÙŠÙˆÙ„Ø©",
    "Ø²Ø­Ù„": "Ø§Ù„Ø£Ù†Ø¸Ù…Ø© ÙˆØ§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ†",
    "Ø§ÙˆØ±Ø§Ù†Ø³": "Ø§Ù„Ø§Ø¨ØªÙƒØ§Ø± ÙˆØ§Ù„Ù…ÙØ§Ø¬Ø£Ø©",
    "Ù†Ø¨ØªÙˆÙ†": "Ø§Ù„Ø®Ø¯Ø¹Ø© ÙˆØ§Ù„Ø§Ø®ØªØ±Ø§Ø¹Ø§Øª",
    "Ø¨Ù„ÙˆØªÙˆ": "Ø§Ù„Ù‡Ø¯Ù… ÙˆØ§Ù„Ø¨Ù†Ø§Ø¡"
}

ASPECT_MEANINGS = {
    "Conjunction": "Ø±Ø¨Ø· Ø¯Ù„Ø§Ù„Ø§Øª ÙƒÙˆÙƒØ¨ÙŠÙ† Ù…Ø¹ Ø¨Ø¹Ø¶ ÙˆØ§Ø³ØªÙ†ØªØ§Ø¬ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©",
    "Opposition": "Ø±Ø¨Ø· Ø¯Ù„Ø§Ù„Ø§Øª ÙƒÙˆÙƒØ¨ÙŠÙ† Ù…Ø¹ Ø¨Ø¹Ø¶ ÙˆØ§Ø³ØªÙ†ØªØ§Ø¬ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©",
    "Trine": "Ø¯Ø¹Ù… ÙˆØ¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ù„Ù„Ø­Ø±ÙƒØ©",
    "Sextile": "Ø¯Ø¹Ù… ÙˆØ¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ø¨Ø¯Ø±Ø¬Ø© Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„ØªØ«Ù„ÙŠØ«",
    "Square": "ØªÙ‚ÙŠÙŠØ¯ ÙˆÙ…Ù‚Ø§ÙˆÙ…Ø© ÙˆØªØ¶ÙŠÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙƒØ©",
    "Ø§Ù‚ØªØ±Ø§Ù†": "Ø±Ø¨Ø· Ø¯Ù„Ø§Ù„Ø§Øª ÙƒÙˆÙƒØ¨ÙŠÙ† Ù…Ø¹ Ø¨Ø¹Ø¶ ÙˆØ§Ø³ØªÙ†ØªØ§Ø¬ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©",
    "Ù…Ù‚Ø§Ø¨Ù„Ø©": "Ø±Ø¨Ø· Ø¯Ù„Ø§Ù„Ø§Øª ÙƒÙˆÙƒØ¨ÙŠÙ† Ù…Ø¹ Ø¨Ø¹Ø¶ ÙˆØ§Ø³ØªÙ†ØªØ§Ø¬ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©",
    "ØªØ«Ù„ÙŠØ«": "Ø¯Ø¹Ù… ÙˆØ¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ù„Ù„Ø­Ø±ÙƒØ©",
    "ØªØ³Ø¯ÙŠØ³": "Ø¯Ø¹Ù… ÙˆØ¥ÙŠØ¬Ø§Ø¨ÙŠØ© Ø¨Ø¯Ø±Ø¬Ø© Ø£Ù‚Ù„ Ù…Ù† Ø§Ù„ØªØ«Ù„ÙŠØ«",
    "ØªØ±Ø¨ÙŠØ¹": "ØªÙ‚ÙŠÙŠØ¯ ÙˆÙ…Ù‚Ø§ÙˆÙ…Ø© ÙˆØªØ¶ÙŠÙŠÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø­Ø±ÙƒØ©"
}

SECTOR_MAPPING = {
    "Aries": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø·Ø§Ù‚Ø© ÙˆØ§Ù„Ù†ÙØ· Ø§Ù„Ø®Ø§Ù…",
    "Taurus": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø£ØºØ°ÙŠØ©",
    "Gemini": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª ÙˆØ§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¨Ø±ÙŠ",
    "Cancer": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆÙ‚Ø·Ø§Ø¹ Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„ØµØ­ÙŠØ©",
    "Leo": "Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªØ±ÙÙŠÙ‡ ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù…",
    "Virgo": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠØ© ÙˆÙ‚Ø·Ø§Ø¹ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© / Ø§Ù„Ø¬Ù…Ø§Ø±Ùƒ",
    "Libra": "Ù‚Ø·Ø§Ø¹ Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚ ÙˆØ§Ù„Ø³Ù†Ø¯Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©",
    "Scorpio": "Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªØ£Ù…ÙŠÙ† ÙˆØ§Ù„Ø¨Ù†ÙˆÙƒ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©",
    "Sagittarius": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø·ÙŠØ±Ø§Ù† (Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¬ÙˆÙŠ) ÙˆØ§Ù„Ø³ÙŠØ§Ø­Ø© ÙˆØ§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ§Ù„ØªØµØ¯ÙŠØ±",
    "Capricorn": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¨Ù†ÙˆÙƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©",
    "Aquarius": "Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØ§Ù„Ø§ØªØµØ§Ù„Ø§Øª (Ø§ÙØªØ±Ø§Ø¶ÙŠ)", # Added default
    "Pisces": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ø¨Ø­Ø±ÙŠØ§Øª (Ø§ÙØªØ±Ø§Ø¶ÙŠ)", # Added default
    "Ø§Ù„Ø­Ù…Ù„": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø·Ø§Ù‚Ø© ÙˆØ§Ù„Ù†ÙØ· Ø§Ù„Ø®Ø§Ù…",
    "Ø§Ù„Ø«ÙˆØ±": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø£ØºØ°ÙŠØ©",
    "Ø§Ù„Ø¬ÙˆØ²Ø§Ø¡": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…ÙˆØ§ØµÙ„Ø§Øª ÙˆØ§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¨Ø±ÙŠ",
    "Ø§Ù„Ø³Ø±Ø·Ø§Ù†": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø¹Ù‚Ø§Ø± ÙˆÙ‚Ø·Ø§Ø¹ Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„ØµØ­ÙŠØ©",
    "Ø§Ù„Ø§Ø³Ø¯": "Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªØ±ÙÙŠÙ‡ ÙˆØ§Ù„Ø¥Ø¹Ù„Ø§Ù…",
    "Ø§Ù„Ø¹Ø°Ø±Ø§Ø¡": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…ÙˆØ§Ø¯ Ø§Ù„Ø§Ø³ØªÙ‡Ù„Ø§ÙƒÙŠØ© ÙˆÙ‚Ø·Ø§Ø¹ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ© / Ø§Ù„Ø¬Ù…Ø§Ø±Ùƒ",
    "Ø§Ù„Ù…ÙŠØ²Ø§Ù†": "Ù‚Ø·Ø§Ø¹ Ø§Ù„ØµÙ†Ø§Ø¯ÙŠÙ‚ ÙˆØ§Ù„Ø³Ù†Ø¯Ø§Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ©",
    "Ø§Ù„Ø¹Ù‚Ø±Ø¨": "Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªØ£Ù…ÙŠÙ† ÙˆØ§Ù„Ø¨Ù†ÙˆÙƒ Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©",
    "Ø§Ù„Ù‚ÙˆØ³": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø·ÙŠØ±Ø§Ù† (Ø§Ù„Ù†Ù‚Ù„ Ø§Ù„Ø¬ÙˆÙŠ) ÙˆØ§Ù„Ø³ÙŠØ§Ø­Ø© ÙˆØ§Ù„Ø§Ø³ØªÙŠØ±Ø§Ø¯ ÙˆØ§Ù„ØªØµØ¯ÙŠØ±",
    "Ø§Ù„Ø¬Ø¯ÙŠ": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø¨Ù†ÙˆÙƒ Ø§Ù„Ù…Ø±ÙƒØ²ÙŠØ©",
    "Ø§Ù„Ø¯Ù„Ùˆ": "Ù‚Ø·Ø§Ø¹ Ø§Ù„ØªÙƒÙ†ÙˆÙ„ÙˆØ¬ÙŠØ§ ÙˆØ§Ù„Ø§ØªØµØ§Ù„Ø§Øª",
    "Ø§Ù„Ø­ÙˆØª": "Ù‚Ø·Ø§Ø¹ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ø¨Ø­Ø±ÙŠØ§Øª"
}

def get_action_reaction_status(deviation: float, is_applying: bool):
    """
    ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© Ø§Ù„ÙØ¹Ù„ ÙˆØ±Ø¯Ø© Ø§Ù„ÙØ¹Ù„ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø§Ù†Ø­Ø±Ø§Ù ÙˆØ­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„.
    Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©:
    - Ù‚Ø¨Ù„ Ø§Ù„ØªÙ…Ø§Ù… (Applying) Ø¨Ù€ 1 Ø¯Ø±Ø¬Ø© = ØªÙØ¹ÙŠÙ„ (ÙØ¹Ù„).
    - Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ…Ø§Ù… (Separating) = ØªØµØ­ÙŠØ­/Ø§Ø±ØªØ¯Ø§Ø¯ (Ø±Ø¯Ø© ÙØ¹Ù„).
    """
    # Ù†Ø¹ØªØ¨Ø± Ø§Ù„Ø²Ø§ÙˆÙŠØ© Ù†Ø´Ø·Ø© ÙÙ‚Ø· Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¶Ù…Ù† 1 Ø¯Ø±Ø¬Ø©
    if deviation > 1.0:
        return None, None

    if is_applying:
        return "Action (ÙØ¹Ù„)", "Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªÙØ¹ÙŠÙ„"
    else:
        return "Reaction (Ø±Ø¯Ø© ÙØ¹Ù„)", "ØªØµØ­ÙŠØ­/Ø§Ø±ØªØ¯Ø§Ø¯"

def check_neptune_rule(planet_name: str, aspect_type: str, other_planet_type: str = "positive"):
    """
    Ù‚Ø§Ø¹Ø¯Ø© Ù†Ø¨ØªÙˆÙ†:
    - Ø§Ù‚ØªØ±Ø§Ù†/Ù…Ù‚Ø§Ø¨Ù„Ø© Ù…Ø¹ ÙƒÙˆÙƒØ¨ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ = Ø§Ø®ØªØ±Ø§Ù‚ ÙˆÙ‡Ù…ÙŠ.
    - Ø§Ù‚ØªØ±Ø§Ù†/Ù…Ù‚Ø§Ø¨Ù„Ø© Ù…Ø¹ ÙƒÙˆÙƒØ¨ Ø³Ù„Ø¨ÙŠ = ÙƒØ³Ø± ÙˆÙ‡Ù…ÙŠ.
    """
    if "Neptune" in planet_name or "Ù†Ø¨ØªÙˆÙ†" in planet_name:
        if aspect_type in ["Conjunction", "Opposition", "Ø§Ù‚ØªØ±Ø§Ù†", "Ù…Ù‚Ø§Ø¨Ù„Ø©"]:
            if other_planet_type == "positive":
                return "âš ï¸ Ø§Ø®ØªØ±Ø§Ù‚ ÙˆÙ‡Ù…ÙŠ (Ù†Ø¨ØªÙˆÙ†)"
            else:
                return "âš ï¸ ÙƒØ³Ø± ÙˆÙ‡Ù…ÙŠ (Ù†Ø¨ØªÙˆÙ†)"
    return ""

def check_mars_rule(planet_name: str, aspect_type: str):
    """
    Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù…Ø±ÙŠØ® (Ø§Ù„ØªØ³Ø§Ø±Ø¹):
    - ØªØ«Ù„ÙŠØ«/ØªØ³Ø¯ÙŠØ³/Ù…Ù‚Ø§Ø¨Ù„Ø©/Ø§Ù‚ØªØ±Ø§Ù† Ù…Ø¹ Ø§Ù„Ø´Ù…Ø³ = Ø¥ÙŠØ¬Ø§Ø¨ÙŠ.
    - ØªØ±Ø¨ÙŠØ¹ = Ø³Ù„Ø¨ÙŠ.
    """
    if "Mars" in planet_name or "Ø§Ù„Ù…Ø±ÙŠØ®" in planet_name:
        if aspect_type in ["Trine", "Sextile", "Opposition", "Conjunction", "ØªØ«Ù„ÙŠØ«", "ØªØ³Ø¯ÙŠØ³", "Ù…Ù‚Ø§Ø¨Ù„Ø©", "Ø§Ù‚ØªØ±Ø§Ù†"]:
             # Note: The user specified Opposition/Conjunction with Sun specifically as positive, 
             # but generally Mars positive aspects are acceleration.
             # We will refine this in the main logic if needed.
             return "ğŸš€ ØªØ³Ø§Ø±Ø¹ Ø¥ÙŠØ¬Ø§Ø¨ÙŠ"
        elif aspect_type in ["Square", "ØªØ±Ø¨ÙŠØ¹"]:
             return "ğŸ›‘ ØªØ³Ø§Ø±Ø¹ Ø³Ù„Ø¨ÙŠ (ØªÙ‚ÙŠÙŠØ¯)"
    return ""

def get_entry_signal(aspect_type: str, deviation: float, is_applying: bool):
    """
    Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„:
    - Ø§Ù„Ø´Ø±Ø§Ø¡ ÙÙŠ Ø­Ø§Ù„ Ø§Ù„ØªØ«Ù„ÙŠØ« Ø¯Ø±Ø¬Ø© Ù‚Ø¨Ù„ Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø£Ùˆ Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø¨Ø§Ù„Ø¶Ø¨Ø·.
    """
    if aspect_type in ["Trine", "ØªØ«Ù„ÙŠØ«"]:
        if is_applying and deviation <= 1.0:
            return "âœ… Ø¥Ø´Ø§Ø±Ø© Ø¯Ø®ÙˆÙ„ (ØªØ«Ù„ÙŠØ« - Ø¨Ø¯Ø§ÙŠØ© ØªÙØ¹ÙŠÙ„)"
    return ""
